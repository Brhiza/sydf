<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>大阿卡纳</title>
    <style>
        /* 背景样式 */
        body {
              font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #87CEFA;
            background: linear-gradient(to bottom right, #9370DB 0, #483D8B 100%);
            overflow: auto;
            position: relative;
            padding-top: 100px
        }

/* 电脑设备（屏幕宽度大于 768px） */
@media (min-width: 769px) {
    body {
        padding-top: 50px; /* 电脑设备留白 */
    }
}

/* 手机设备（屏幕宽度小于等于 768px） */
@media (max-width: 768px) {
    body {
        padding-top: 50px; /* 手机设备留白 */
    }
}

        
        /* 背景气泡动画 */
        .bg-bubbles {
            position: fixed; /* 改为 fixed，固定在背景上 */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0; /* 背景气泡的 z-index 设置为 0 */
        }

        .bg-bubbles li {
            position: absolute;
            list-style: none;
            display: block;
            width: 40px;
            height: 40px;
            background-color: hsla(0, 0%, 100%, .15);
            bottom: -160px;
            animation: square 25s infinite;
            transition-timing-function: linear;
        }

        .bg-bubbles li:nth-child(1) {
            left: 10%;
        }

        .bg-bubbles li:nth-child(2) {
            left: 20%;
            width: 80px;
            height: 80px;
            animation-delay: 2s;
            animation-duration: 17s;
        }

        .bg-bubbles li:nth-child(3) {
            left: 25%;
            animation-delay: 4s;
        }

        .bg-bubbles li:nth-child(4) {
            left: 40%;
            width: 60px;
            height: 60px;
            animation-duration: 22s;
            background-color: hsla(0, 0%, 100%, .25);
        }

        .bg-bubbles li:nth-child(5) {
            left: 70%;
        }

        .bg-bubbles li:nth-child(6) {
            left: 80%;
            width: 120px;
            height: 120px;
            animation-delay: 3s;
            background-color: hsla(0, 0%, 100%, .2);
        }

        .bg-bubbles li:nth-child(7) {
            left: 32%;
            width: 160px;
            height: 160px;
            animation-delay: 7s;
        }

        .bg-bubbles li:nth-child(8) {
            left: 55%;
            width: 20px;
            height: 20px;
            animation-delay: 15s;
            animation-duration: 40s;
        }

        .bg-bubbles li:nth-child(9) {
            left: 25%;
            width: 10px;
            height: 10px;
            animation-delay: 2s;
            animation-duration: 40s;
            background-color: hsla(0, 0%, 100%, .3);
        }

        .bg-bubbles li:nth-child(10) {
            left: 90%;
            width: 160px;
            height: 160px;
            animation-delay: 11s;
        }

        @keyframes square {
            0% {
                transform: translateY(0);
            }
            to {
                transform: translateY(-700px) rotate(600deg);
            }
        }

        /* 内容框样式 */
        .content-box {
            width: 90%;
            max-width: 1200px;
            min-width: 300px;
                padding: 20px; /* 减少 padding */
    box-sizing: border-box; /* 确保 padding 不会增加宽度 */
            border-radius: 20px; /* 圆角矩形 */
            background: rgba(255, 255, 255, 0.2); /* 毛玻璃背景 */
            backdrop-filter: blur(10px); /* 毛玻璃效果 */
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2); /* 阴影 */
            z-index: 2; /* 确保内容框在背景气泡之上 */
            position: relative; /* 相对定位 */
        }

    .card-container {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 0;
      overflow: visible;
    }

    .card-row {
      display: flex;
      justify-content: center;
      gap: -1rem;
      flex-wrap: wrap;
    }

    .card {
      width: 6rem;
      height: 9rem;
      border: 1px solid #ccc;
      margin: 0.2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
      position: relative;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      transition: opacity 0.5s ease-in-out, transform 0.3s ease-in-out;
    }

    @media (max-width: 768px) {
      .card {
        width: 2.5rem;
        height: 4rem;
      }

      .card-row {
        gap: 0rem;
      }

      .input-container input {
        width: 90%;
        max-width: 100%;
      }
    }

    @media (min-width: 769px) {
      .card {
        width: 6rem;
        height: 9rem;
      }
    }

    .card.hidden {
      opacity: 0;
    }

        .result-container {
            width: 90%;
            max-width: 1200px;
            overflow: auto; /* 超出部分滚动 */
            box-sizing: border-box; /* 包含 padding 和 border */
            display: flex;
            flex-wrap: wrap; /* 允许换行 */
            gap: 10px; /* 子元素间距 */
            align-items: center;
            justify-content: center;
            margin-top: 2rem;
        }
        .result-container img {
            max-width: 100%; /* 图片宽度不超过容器 */
            height: auto; /* 高度自适应 */
        }
        .result-container p {
            word-wrap: break-word; /* 允许长单词换行 */
            margin: 0;
        }

    .reset-button,
    .copy-button,
    .ai-button {
      margin-top: 2rem;
      padding: 0.75rem 1rem;
      font-size: 1rem;
      cursor: pointer;
      background-color: #8A2BE2;
      color: white;
      border: none;
      border-radius: 5px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s ease-in-out;
    }

    .reset-button:hover,
    .copy-button:hover,
    .ai-button:hover {
      background-color: #8A2BE2;
    }

    .centered {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }


h1 {
  font-size: 48px; /* 默认字体大小 */
  color: #fff;
  margin-bottom: 30px;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
  flex-direction: column;
  align-items: center;
  text-align: center;
}

/* 针对手机设备的样式 */
@media (max-width: 768px) {
  h1 {
    font-size: 32px; /* 手机端字体大小 */
  }
}
        
    .input-container {
            font-size: 24px;
            color: #fff;
            margin-bottom: 30px;
                  flex-direction: column;
      align-items: center;
      text-align: center;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .input-container input {
      width: 90%;
      max-width: 100%;
      padding: 1rem;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
            background: rgba(255, 255, 255, 0.2); /* 毛玻璃背景 */
            backdrop-filter: blur(10px);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      transition: border-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
      margin-top: 0.5rem;
    }

    .input-container input:focus {
      outline: none;
      border-color: #007bff;
      box-shadow: 0 2px 8px rgba(0, 123, 255, 0.2);
    }

    .output-text {
      margin-top: 2rem;
      font-size: 1.2rem;
      font-weight: bold;
      color: #F5F5F5;
      padding: 1rem;
      border-radius: 5px;
    }

    .output-text strong {
      font-size: 1.4rem;
      font-weight: bold;
      color: #F5F5F5;
    }

    .output-text em {
      font-size: 1.1rem;
      font-style: italic;
      color: #F5F5F5;
    }

    .button-container {
      display: flex;
      gap: 1rem;
      margin-top: 2rem;
    }

    .loading-animation {
      display: none;
      margin-top: 2rem;
      font-size: 1.2rem;
      font-weight: bold;
      color: #FFF;
      text-align: center;
            background: rgba(255, 255, 255, 0.2); /* 毛玻璃背景 */
            backdrop-filter: blur(10px);
      padding: 1rem;
      border-radius: 5px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .loading-animation::after {
      content: 'AI疯狂思考中...';
      animation: loading 1s infinite;
    }

    @keyframes loading {
      0% {
        content: 'AI疯狂思考中.';
      }

      33% {
        content: 'AI疯狂思考中..';
      }

      66% {
        content: 'AI疯狂思考中...';
      }

      100% {
        content: 'AI疯狂思考中.';
      }
    }

    #outputText .highlight {
      background-color: #fff3cd;
      padding: 2px 4px;
      border-radius: 4px;
    }

    #outputText blockquote {
      border-left: 4px solid #6c757d;
      padding-left: 1em;
      margin-left: 0;
      color: #6c757d;
    }

    .draw-button {
        padding: 1rem 2rem;
        font-size: 1.2rem;
        cursor: pointer;
        background-color: #8A2BE2;
        color: white;
        border: none;
        border-radius: 5px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        transition: background-color 0.3s ease-in-out;
        margin: 2rem 0;
    }

    .draw-button:hover {
        background-color: #9932CC;
    }

    .placeholder-card {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 2rem 0;
    }

    .placeholder-card img {
        width: 150px;
        height: auto;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
    }

    .placeholder-card img:hover {
        transform: scale(1.05);
    }

    /* 手机端响应式样式 */
    @media (max-width: 768px) {
        .placeholder-card img {
            width: 100px;
        }
    }

    .card-wrapper {
        perspective: 1000px;
        width: 200px;
        height: 300px;
        margin: 0 auto;
    }

    .card-inner {
        position: relative;
        width: 100%;
        height: 100%;
        text-align: center;
        transition: transform 0.8s;
        transform-style: preserve-3d;
    }

    .card-inner.flipped {
        transform: rotateY(180deg);
    }

    .card-front, .card-back {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .card-back {
        transform: rotateY(180deg);
    }

    #drawnCard {
        width: 100%;
        height: 100%;
    }

    .tarot-card {
        width: 100%;
        height: 100%;
        object-fit: contain;
    }

    .input-container select {
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        cursor: pointer;
        transition: border-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
    }

    .input-container select:focus {
        outline: none;
        border-color: #007bff;
        box-shadow: 0 2px 8px rgba(0, 123, 255, 0.2);
    }

    .input-container select option {
        background: rgba(255, 255, 255, 0.9);
        color: #333;
        padding: 10px;
    }

    .question-options {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center;
        margin: 20px 0;
    }

    .question-btn {
        padding: 12px 24px;
        border: none;
        border-radius: 20px;
        background: rgba(255, 255, 255, 0.1);
        color: white;
        cursor: pointer;
        transition: all 0.3s ease;
        backdrop-filter: blur(5px);
        font-size: 1rem;
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .question-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-2px);
    }

    .question-btn.active {
        background: rgba(138, 43, 226, 0.6);
        border-color: rgba(138, 43, 226, 0.8);
        box-shadow: 0 0 15px rgba(138, 43, 226, 0.3);
    }

    @media (max-width: 768px) {
        .question-btn {
            padding: 8px 16px;
            font-size: 0.9rem;
        }
        
        .question-options {
            gap: 8px;
        }
    }

    .button-container {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin-top: 20px;
    }

    .copy-button, .reset-button {
        padding: 10px 20px;
        border: none;
        border-radius: 20px;
        background: rgba(255, 255, 255, 0.1);
        color: white;
        cursor: pointer;
        transition: all 0.3s ease;
        backdrop-filter: blur(5px);
        font-size: 1rem;
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .copy-button:hover, .reset-button:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-2px);
    }

    .reminder-text {
        font-size: 1.3rem;
        opacity: 0.8;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }

    /* 针对引导文字的特殊样式 */
    .input-container .reminder-text {
        font-size: 1.5rem;
        line-height: 2;
        color: #fff !important;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        font-weight: 500;
        letter-spacing: 1px;
    }

    /* 针对手机端的响应式样式 */
    @media (max-width: 768px) {
        .input-container .reminder-text {
            font-size: 1.2rem;
            line-height: 1.8;
        }
    }
    </style>
        <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <!-- 背景气泡动画 -->
    <ul class="bg-bubbles">
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
    </ul>

    <!-- 内容框 -->
    <h1>时月的大阿卡纳</h1>
    <div class="content-box">
    <div class="input-container">
      <div class="reminder-text" style="margin: 20px 0; color: #fff; text-align: center; ">
        现在静下心来<br/>
        选择并心中默念困扰你的问题<br/>
        然后点击重新一张塔罗牌
    </div>
        <div class="question-options">
            <button class="question-btn active" data-value="综合运势">综合运势</button>
            <button class="question-btn" data-value="事业运势">事业运势</button>
            <button class="question-btn" data-value="学业运势">学业运势</button>
            <button class="question-btn" data-value="财运">财运</button>
            <button class="question-btn" data-value="感情运势">感情运势</button>
            <button class="question-btn" data-value="幸运数字">幸运数字</button>
            <button class="question-btn" data-value="本周运势">本周运势</button>
        </div>
        <input type="hidden" id="inputText" value="综合运势">
    </div>
    
    <!-- 卡片容器结构 -->
    <div class="card-container">
        <div class="card-wrapper">
            <div class="card-inner" id="cardInner">
                <div class="card-front">
                    <img src="https://sydf.cc/img/today/00.jpg" alt="塔罗牌背面" class="tarot-card">
                </div>
                <div class="card-back">
                    <div id="drawnCard"></div>
                </div>
            </div>
        </div>
    </div>
    
    <main class="centered">
        <div class="output-text" id="outputText"></div>
        <div class="loading-animation" id="loadingAnimation"></div>
        <div class="reminder-text" style="margin: 15px 0; color: #fff; text-align: center; display: none;" id="reminderText">
            短时间内请不要重复抽取同一个问题，塔罗牌并不能改变你的整体运势，也不是你逃避现实的工具
        </div>
        <div class="button-container" style="margin-top: 20px;">
            <button class="copy-button centered" id="copyButton" onclick="copyResult()" style="display: none;">复制结果</button>
            <button class="reset-button centered" id="resetButton" onclick="resetCards()" style="display: none;">重新抽牌</button>
        </div>
    </main>
    </div>

    <script>
const allTarotCards = [
  // 大阿卡纳 (22张)
  {name: "愚人", number: "m00"},
  {name: "魔术师", number: "m01"},
  {name: "女祭司", number: "m02"},
  {name: "皇后", number: "m03"},
  {name: "皇帝", number: "m04"},
  {name: "教皇", number: "m05"},
  {name: "恋人", number: "m06"},
  {name: "战车", number: "m07"},
  {name: "力量", number: "m08"},
  {name: "隐士", number: "m09"},
  {name: "命运之轮", number: "m10"},
  {name: "正义", number: "m11"},
  {name: "倒吊人", number: "m12"},
  {name: "死神", number: "m13"},
  {name: "节制", number: "m14"},
  {name: "恶魔", number: "m15"},
  {name: "高塔", number: "m16"},
  {name: "星星", number: "m17"},
  {name: "月亮", number: "m18"},
  {name: "太阳", number: "m19"},
  {name: "审判", number: "m20"},
  {name: "世界", number: "m21"},
  
  // 圣杯牌 Cups (14张)
  {name: "圣杯王牌", number: "c01"},
  {name: "圣杯二", number: "c02"},
  {name: "圣杯三", number: "c03"},
  {name: "圣杯四", number: "c04"},
  {name: "圣杯五", number: "c05"},
  {name: "圣杯六", number: "c06"},
  {name: "圣杯七", number: "c07"},
  {name: "圣杯八", number: "c08"},
  {name: "圣杯九", number: "c09"},
  {name: "圣杯十", number: "c10"},
  {name: "圣杯侍从", number: "c11"},
  {name: "圣杯骑士", number: "c12"},
  {name: "圣杯皇后", number: "c13"},
  {name: "圣杯国王", number: "c14"},
  
  // 钱币牌 Pentacles (14张)
  {name: "钱币王牌", number: "p01"},
  {name: "钱币二", number: "p02"},
  {name: "钱币三", number: "p03"},
  {name: "钱币四", number: "p04"},
  {name: "钱币五", number: "p05"},
  {name: "钱币六", number: "p06"},
  {name: "钱币七", number: "p07"},
  {name: "钱币八", number: "p08"},
  {name: "钱币九", number: "p09"},
  {name: "钱币十", number: "p10"},
  {name: "钱币侍从", number: "p11"},
  {name: "钱币骑士", number: "p12"},
  {name: "钱币皇后", number: "p13"},
  {name: "钱币国王", number: "p14"},
  
  // 宝剑牌 Swords (14张)
  {name: "宝剑王牌", number: "s01"},
  {name: "宝剑二", number: "s02"},
  {name: "宝剑三", number: "s03"},
  {name: "宝剑四", number: "s04"},
  {name: "宝剑五", number: "s05"},
  {name: "宝剑六", number: "s06"},
  {name: "宝剑七", number: "s07"},
  {name: "宝剑八", number: "s08"},
  {name: "宝剑九", number: "s09"},
  {name: "宝剑十", number: "s10"},
  {name: "宝剑侍从", number: "s11"},
  {name: "宝剑骑士", number: "s12"},
  {name: "宝剑皇后", number: "s13"},
  {name: "宝剑国王", number: "s14"},
  
  // 权杖牌 Wands (14张)
  {name: "权杖王牌", number: "w01"},
  {name: "权杖二", number: "w02"},
  {name: "权杖三", number: "w03"},
  {name: "权杖四", number: "w04"},
  {name: "权杖五", number: "w05"},
  {name: "权杖六", number: "w06"},
  {name: "权杖七", number: "w07"},
  {name: "权杖八", number: "w08"},
  {name: "权杖九", number: "w09"},
  {name: "权杖十", number: "w10"},
  {name: "权杖侍从", number: "w11"},
  {name: "权杖骑士", number: "w12"},
  {name: "权杖皇后", number: "w13"},
  {name: "权杖国王", number: "w14"}
];
        const cdnBaseUrl = "https://sydf.cc/img/today/";
        const defaultCardImage = `${cdnBaseUrl}00.jpg`;
        let cards = [];
        let drawnCards = [];
        let drawCount = 0;
        let isCardClickable = true;

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function initCards() {
            cards = shuffleArray(Array.from({ length: 78 }, (_, i) => i));
        }

        function createCardElement(cardNumber) {
            const cardElement = document.createElement('div');
            cardElement.classList.add('card');
            cardElement.dataset.number = cardNumber;
            cardElement.style.backgroundImage = `url(${defaultCardImage})`;
            cardElement.addEventListener('click', drawCard);
            return cardElement;
        }

        function displayCards() {
            console.log("displayCards called"); // 调试
            const cardContainer = document.getElementById('cardContainer');
            cardContainer.innerHTML = '';
            const row1 = document.createElement('div');
            row1.classList.add('card-row');
            const row2 = document.createElement('div');
            row2.classList.add('card-row');
            cards.forEach((cardNumber, index) => {
                const cardElement = createCardElement(cardNumber);
                if (index < 11) {
                    row1.appendChild(cardElement);
                } else {
                    row2.appendChild(cardElement);
                }
            });
            cardContainer.appendChild(row1);
            cardContainer.appendChild(row2);
        }

    function generateResultContent(card) {
      const imgPath = `${cdnBaseUrl}${card.number}.jpg`;
      const transformStyle = card.reversed ? "rotate(180deg)" : "none";
      const cardWidth = window.innerWidth <= 768 ? '4rem' : '8rem';
      const cardHeight = window.innerWidth <= 768 ? '6rem' : '11rem';
      const cardName = `${card.reversed ? "逆位" : ""}${card.name}`;
      return `<div style="display: flex; flex-direction: column; align-items: center;"><img src='${imgPath}' style='width: ${cardWidth}; height: ${cardHeight}; transform:${transformStyle}' alt='${cardName}'><p>${cardName}</p></div>`;
    }

    function drawCard() {
      if (!isCardClickable) return;
      isCardClickable = false;
      const inputText = document.getElementById('inputText').value;
      if (!inputText.trim()) {
        alert("你还没有写下问题呢");
        isCardClickable = true;
        return;
      }
      
      const cardIndex = this.dataset.number;
      const isReversed = Math.random() < 0.5;
      const card = allTarotCards[cardIndex];
      
      // 修改图片路径生成逻辑
      const cardImagePath = `${cdnBaseUrl}${card.number}.jpg`;
      
      if (!this.classList.contains('flipped')) {
        this.style.backgroundImage = `url(${cardImagePath})`;
        this.style.transform = isReversed ? "rotate(180deg)" : "none";
      }
      
      drawnCards.push({
        number: cardIndex,
        reversed: isReversed,
        description: isReversed ? cardDescriptions[cardIndex].reversed : cardDescriptions[cardIndex].upright
      });
      drawCount++;
      this.classList.add('flipped');
      const resultContainer = document.getElementById('resultContainer');
      resultContainer.innerHTML += generateResultContent({
        number: cardIndex,
        reversed: isReversed
      });
      this.classList.add('hidden');
      this.removeEventListener('click', drawCard);
      setTimeout(() => {
        isCardClickable = true;
      }, 500);
      if (drawCount === 3) {
        const resetButton = document.getElementById('resetButton');
        resetButton.style.display = 'block';
        const copyButton = document.getElementById('copyButton');
        copyButton.style.display = 'block';
        const aiButton = document.getElementById('aiButton');
        aiButton.style.display = 'block';
        const cardElements = document.querySelectorAll('.card');
        cardElements.forEach(card => card.removeEventListener('click', drawCard));
        const outputText = document.getElementById('outputText');
        const cardNames = drawnCards.map(card => `<strong>${card.reversed ? "逆位" : ""}${majorArcanaCardNames[card.number]}</strong>`).join('、');
        const cardDescriptionsText = drawnCards.map(card => `<em>${card.reversed ? "逆位" : ""}${majorArcanaCardNames[card.number]}，代表${card.description}</em>`).join('<br>');
        const resultText = `${cardNames}<br>${inputText}<br><br><strong>牌意简介</strong><br>${cardDescriptionsText}`;
        outputText.innerHTML = resultText;
      }
    }

    function resetCards() {
        // 刷新页面
        window.location.reload();
    }

    // 或者如果你不想刷新页面，可以尝试这个完整的重置版本：
    function resetCards() {
        // 重置抽牌数组
        drawnCards = [];
        
        // 重置卡片到初始状态
        const cardInner = document.querySelector('.card-inner');
        if (cardInner) {
            // 移除所有类
            cardInner.className = 'card-inner';
            
            // 重置卡片正面图片
            const frontImg = cardInner.querySelector('.card-front img');
            if (frontImg) {
                frontImg.src = 'https://sydf.cc/img/today/00.jpg';
            }
        }
        
        // 清空抽取的卡片内容
        const drawnCard = document.getElementById('drawnCard');
        if (drawnCard) {
            drawnCard.innerHTML = '';
        }
        
        // 重置按钮状态
        const resetButton = document.getElementById('resetButton');
        const copyButton = document.getElementById('copyButton');
        if (resetButton) resetButton.style.display = 'none';
        if (copyButton) copyButton.style.display = 'none';
        
        // 清空输出文本
        const outputText = document.getElementById('outputText');
        if (outputText) {
            outputText.innerHTML = '';
        }
        
        // 重置问题选择
        const questionButtons = document.querySelectorAll('.question-btn');
        questionButtons.forEach(btn => btn.classList.remove('active'));
        
        // 清空输入
        const inputText = document.getElementById('inputText');
        if (inputText) {
            inputText.value = '';
        }
        
        // 重置时隐藏提示文字
        document.getElementById('reminderText').style.display = 'none';
    }

    function copyResult() {
      const outputText = document.getElementById('outputText').innerText;
      navigator.clipboard.writeText(outputText).then(() => {
        alert("结果已复制到剪贴板");
      }).catch(err => {
        alert("复制失败: " + err);
      });
    }

async function aiInterpretation() {
    const inputText = document.getElementById('inputText').value;
    const cardNames = drawnCards.map(card => `${card.reversed ? "逆位" : ""}${card.name}`).join('、');
    
    // 根据不同问题类型设置不同的提示词
    let prompt = '';
    switch(inputText) {
        case '综合运势':
            prompt = `我抽到了${cardNames}，请从今日整体运势、事业发展、感情状况等方面为我解读这张牌的寓意。请特别说明这是今日运势。格式如下，今日运势解读、具体建议、总结`;
            break;
        case '事业运势':
            prompt = `我抽到了${cardNames}，请从今日工作发展、职业规划、事业机遇等方面为我解读这张牌的寓意。请特别说明这是今日运势。格式如下，事业运解读、具体建议、总结`;
            break;
        case '学业运势':
            prompt = `我抽到了${cardNames}，请从今日学习状态、考试成绩、未来规划等方面为我解读这张牌的寓意。请特别说明这是今日运势。格式如下，学业运解读、具体建议、总结`;
            break;
        case '财运':
            prompt = `我抽到了${cardNames}，请从今日财务状况、理财机会、收入变化等方面为我解读这张牌的寓意。请特别说明这是今日运势。格式如下，财运解读、具体建议、总结`;
            break;
        case '感情运势':
            prompt = `我抽到了${cardNames}，请从今日感情状况、桃花运、人际关系等方面为我解读这张牌的寓意。请特别说明这是今日运势。格式如下，感情运解读、具体建议、总结`;
            break;
        case '幸运数字':
            prompt = `我抽到了${cardNames}，请根据这张牌的寓意为我推荐今日的幸运数字，并解释这个数字的含义。请特别说明这是今日运势。`;
            break;
        case '本周运势':
            prompt = `我抽到了${cardNames}，请从本周的整体运势、事业发展、感情状况、财运等方面为我解读这张牌的寓意。请特别强调这是对本周（未来7天）的预测，并给出每个方面具体的建议。格式如下，本周运势解读、具体建议、总结`;
            break;
    }

    // 如果没有选择问题类型，提示用户
    if (!prompt) {
        alert("请先选择想要解答的问题");
        return;
    }

    const outputText = document.getElementById('outputText');
    const loadingAnimation = document.getElementById('loadingAnimation');
    const currentContent = outputText.innerHTML;
    loadingAnimation.style.display = 'block';

    try {
      const response = await fetch('https://api.ikun.jp/api/ai-interpretation', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json'
        },
        body: JSON.stringify({
          messages: [{
              content: "你是一个专业的塔罗师，你会根据我的问题和抽的牌给我解决问题。请用简洁易懂的语言回答，并给出具体的建议。",
              role: "system"
            },
            {
              content: prompt,
              role: "user"
            }
          ],
          model: "deepseek-chat",
          frequency_penalty: 0,
          max_tokens: 2048,
          presence_penalty: 0,
          response_format: {
            type: "text"
          },
          stop: null,
          stream: false,
          temperature: 1,
          top_p: 1,
          tools: null,
          tool_choice: "none",
          logprobs: false,
          top_logprobs: null
        })
      });

      if (!response.ok) {
        throw new Error(await response.text());
      }

      const data = await response.json();
      const aiResponse = data.choices[0].message.content;
      const htmlContent = marked.parse(aiResponse);

      loadingAnimation.style.display = 'none';
      outputText.innerHTML = `${currentContent}<br><br><strong>AI 解读</strong><br>${htmlContent}`;
      
      // AI 解读完成后显示按钮和提示文字
      document.getElementById('copyButton').style.display = 'inline-block';
      document.getElementById('resetButton').style.display = 'inline-block';
      document.getElementById('reminderText').style.display = 'block';
    } catch (error) {
      console.error("AI解读失败: ", error);
      alert("AI解读失败: " + error.message);
      loadingAnimation.style.display = 'none';
    }
}

    function typeWriter(text, element, minSpeed = 10, maxSpeed = 30) {
      let i = 0;
      element.innerHTML = '';
      
      function type() {
        if (i < text.length) {
          element.innerHTML += text.charAt(i);
          i++;
          const randomSpeed = Math.floor(Math.random() * (maxSpeed - minSpeed + 1)) + minSpeed;
          setTimeout(type, randomSpeed);
        }
      }
      
      type();
    }

    async function drawRandomCard() {
        const inputText = document.getElementById('inputText').value;
        if (!inputText.trim()) {
            alert("请先选择想要解答的问题");
            return;
        }

        const cardInner = document.querySelector('.card-inner');
        cardInner.classList.add('flipped');  // 添加翻转类名

        const cardIndex = Math.floor(Math.random() * allTarotCards.length);
        const isReversed = Math.random() < 0.5;
        const card = allTarotCards[cardIndex];
        
        const drawnCard = document.getElementById('drawnCard');
        
        const cardContainer = document.createElement('div');
        cardContainer.style.display = 'flex';
        cardContainer.style.flexDirection = 'column';
        cardContainer.style.alignItems = 'center';
        cardContainer.style.height = '100%';
        
        const newCardImg = document.createElement('img');
        newCardImg.src = `${cdnBaseUrl}${card.number}.jpg`;
        newCardImg.alt = card.name;
        newCardImg.className = 'tarot-card';
        newCardImg.style.marginBottom = '10px';
        
        if (isReversed) {
            newCardImg.style.transform = 'rotate(180deg)';
        }
        
        const cardName = document.createElement('div');
        cardName.textContent = `${isReversed ? "逆位 " : ""}${card.name}`;
        cardName.style.color = '#fff';
        cardName.style.fontSize = '1.2rem';
        cardName.style.textAlign = 'center';
        cardName.style.marginTop = '10px';
        cardName.style.textShadow = '2px 2px 4px rgba(0, 0, 0, 0.3)';
        
        cardContainer.appendChild(newCardImg);
        cardContainer.appendChild(cardName);
        
        drawnCard.innerHTML = '';
        drawnCard.appendChild(cardContainer);

        drawnCards.push({
            number: card.number,
            reversed: isReversed,
            name: card.name,
            description: isReversed ? cardDescriptions[cardIndex].reversed : cardDescriptions[cardIndex].upright
        });

        const outputText = document.getElementById('outputText');
        const cardDescription = `<em>${isReversed ? cardDescriptions[cardIndex].reversed : cardDescriptions[cardIndex].upright}</em>`;
        outputText.innerHTML = `<strong>牌意简介</strong><br>${cardDescription}`;

        // 自动进行 AI 解读
        await aiInterpretation();
    }

    // 将卡牌点击处理函数单独定义，这样可以正确地添加和移除
    async function handleCardClick(e) {
        if (!this.classList.contains('flipped')) {
            await drawRandomCard();
        }
    }

    // 修改 DOMContentLoaded 事件处理函数
    document.addEventListener('DOMContentLoaded', function() {
        // 初始化卡片
        initCards();
        
        // 问题选择按钮的事件监听
        const questionButtons = document.querySelectorAll('.question-btn');
        const hiddenInput = document.getElementById('inputText');

        questionButtons.forEach(button => {
            button.addEventListener('click', function() {
                // 移除所有按钮的 active 类
                questionButtons.forEach(btn => btn.classList.remove('active'));
                // 为当前点击的按钮添加 active 类
                this.classList.add('active');
                // 更新隐藏输入框的值
                hiddenInput.value = this.getAttribute('data-value');
            });
        });

        // 初始卡牌点击事件
        const cardInner = document.querySelector('.card-inner');
        cardInner.addEventListener('click', handleCardClick);
    });

        document.addEventListener('DOMContentLoaded', initCards);

        const cardDescriptions = [
  // 大阿卡纳 (0-21)
  {
    upright: "开端、自由、纯真、独创性、冒险、理想主义、自发性",
    reversed: "鲁莽、粗心、分心、幼稚、愚蠢、容易上当、陈旧、迟钝"
  },
  {
    upright: "意志力、欲望、足智多谋、技能、能力、专注、表现",
    reversed: "操纵、狡猾、诡计、浪费天赋、错觉、欺骗"
  },
  {
    upright: "无意识、直觉、神秘、灵性、更高的力量、内在的声音",
    reversed: "被压抑的直觉、隐藏的动机、肤浅、困惑、认知失调"
  },
  {
    upright: "神圣的女性、性感、生育力、培育、创造力、美丽、丰富、自然",
    reversed: "不安全、专横、疏忽、窒息、缺乏成长、缺乏进步"
  },
  {
    upright: "稳定性、结构、保护、权威、控制、实用性、重点、纪律",
    reversed: "暴君、霸道、死板、固执、缺乏纪律、鲁莽"
  },
  {
    upright: "传统、社会群体、约定俗成、从众、教育、知识、信仰",
    reversed: "叛逆、非常规、不循规蹈矩、新方法、无知"
  },
  {
    upright: "爱、工会、伙伴关系、关系、选择、浪漫、平衡、团结",
    reversed: "不和谐、不平衡、冲突、超脱、错误的选择、优柔寡断"
  },
  {
    upright: "成功、雄心、决心、意志力、控制力、自律、专注",
    reversed: "有力、没有方向、没有控制、无力、侵略、障碍"
  },
  {
    upright: "勇气、勇敢、自信、同情、自信、内在力量",
    reversed: "自我怀疑、软弱、低信心、不足、怯懦、强硬"
  },
  {
    upright: "自我反省、内省、沉思、退缩、孤独、寻找自我",
    reversed: "孤独、孤立、隐居、反社会、拒绝、回归社会"
  },
  {
    upright: "变化、周期、命运、决定性时刻、运气、财富、突发事件",
    reversed: "运气不好、缺乏控制、执着于控制、不受欢迎的变化、延误"
  },
  {
    upright: "正义、业力、后果、责任、法律、真相、诚实、正直、因果",
    reversed: "不公正、报复、不诚实、腐败、不诚实、不公平、逃避责任"
  },
  {
    upright: "牺牲、等待、不确定、缺乏方向、视角、沉思",
    reversed: "拖延、漠不关心、停滞不前、避免牺牲、冷漠"
  },
  {
    upright: "转变、结局、改变、过渡、放手、释放",
    reversed: "害怕改变、重复消极的模式、抵制改变、停滞不前、腐朽"
  },
  {
    upright: "平衡、和平、耐心、适度、平静、安宁、和谐、宁静",
    reversed: "不平衡、过度、极端、不和谐、鲁莽、仓促"
  },
  {
    upright: "压迫、成瘾、痴迷、依赖、过度、无力、局限",
    reversed: "独立、自由、启示、释放、收回权力、收回控制"
  },
  {
    upright: "灾难、破坏、剧变、创伤、突变、混乱",
    reversed: "避免灾难、延迟不可避免的、抵制变化"
  },
  {
    upright: "希望、灵感、积极性、信念、更新、治愈、复兴",
    reversed: "绝望、绝望、消极、缺乏信心、沮丧"
  },
  {
    upright: "错觉、直觉、不确定性、困惑、复杂性、秘密、无意识",
    reversed: "恐惧、欺骗、焦虑、误解、曲解、清晰、理解"
  },
  {
    upright: "幸福、成功、乐观、活力、喜悦、自信、真理",
    reversed: "幸福受阻、过度热情、悲观、不切实际的期望、自负"
  },
  {
    upright: "自我评价、觉醒、更新、目的、反思、清算",
    reversed: "自我怀疑、缺乏自我意识、未能吸取教训、自我厌恶"
  },
  {
    upright: "完成、成就、成就感、归属感、整体性、和谐",
    reversed: "缺乏封闭感、缺乏成就感、感觉不完整、空虚"
  },

  // 圣杯牌 (22-35)
  {
    upright: "爱、新感觉、情感觉醒、创造力、灵性、直觉",
    reversed: "冷漠、空虚、情绪失落、创造力受阻、感觉不被爱"
  },
  {
    upright: "团结、伙伴关系、吸引力、联系、紧密联系、联合力量、相互尊重",
    reversed: "分离、拒绝、分裂、不平衡、紧张、沟通不良、退缩"
  },
  {
    upright: "友谊、社区、聚会、庆祝活动、团体活动、社交活动",
    reversed: "八卦、丑闻、过度、孤立、孤独、孤独、不平衡的社会生活"
  },
  {
    upright: "冷漠、沉思、感觉与世隔绝、忧郁、无聊、不满",
    reversed: "清晰、意识、接受、选择幸福、抑郁、消极"
  },
  {
    upright: "失落、悲伤、失望、哀悼、不满",
    reversed: "接受、继续前进、寻找平静、满足、看到积极的一面"
  },
  {
    upright: "怀旧、回忆、熟悉、治愈、安慰、多愁善感、愉悦",
    reversed: "被困在、前进、离家、独立"
  },
  {
    upright: "选择、寻找目标、幻想、白日梦、一厢情愿、优柔寡断",
    reversed: "缺乏目标、混乱、混乱、转移、分心、清晰、做出选择"
  },
  {
    upright: "放弃、走开、放手、寻找真相、留下",
    reversed: "停滞、单调、接受较少、回避、害怕改变、处于糟糕的境地"
  },
  {
    upright: "愿望成真、满足、成功、成就、认可、快乐",
    reversed: "不快乐、缺乏满足感、失望、成绩不佳、傲慢、势利"
  },
  {
    upright: "幸福、回家、满足、情绪稳定、安全、家庭和谐",
    reversed: "不愉快的家、分离、家庭冲突、不和谐、孤立"
  },
  {
    upright: "理想主义、敏感、梦想家、天真",
    reversed: "情绪脆弱、不成熟、忽视内在小孩、逃避现实、不安全感"
  },
  {
    upright: "理想主义者、迷人艺术的、优雅的、委婉的、外交的、调解人、谈判者",
    reversed: "失望、发脾气、喜怒无常、混乱、避免冲突、虚荣"
  },
  {
    upright: "同情、温暖、善良、直觉、支持",
    reversed: "不安全、给予太多、过于敏感、有需要的、脆弱、依赖"
  },
  {
    upright: "明智的、外交的、头脑和心灵之间的平衡、忠诚的",
    reversed: "不知所措、焦虑、冷漠、压抑、孤僻、控制欲强、自私"
  },

  // 钱币牌 (36-49)
  {
    upright: "新机会、资源、丰富、繁荣、安全、稳定、表现",
    reversed: "错失机会、稀缺、不足、不稳定、吝啬、错误的投资"
  },
  {
    upright: "平衡资源、适应、足智多谋、灵活性、拉伸资源",
    reversed: "不平衡、无组织、不堪重负、凌乱、混乱、过度扩张"
  },
  {
    upright: "团队合作、共同目标、协作、学徒、努力、集中精力",
    reversed: "缺乏凝聚力、缺乏团队合作、冷漠、动力不足、冲突、自我、竞争"
  },
  {
    upright: "占有欲、不安全感、吝啬、稳定、安全、财富、节俭、界限",
    reversed: "慷慨、给予、消费、开放、财务不安全、鲁莽消费"
  },
  {
    upright: "困难、损失、孤立、感觉被遗弃、逆境、斗争、失业、疏远、耻辱",
    reversed: "积极的改变、从损失中恢复、克服逆境、宽恕、感到受欢迎"
  },
  {
    upright: "慷慨、慈善、社区、物质帮助、支持、分享、给予和接受、感恩",
    reversed: "权力动态、滥用慷慨、附带礼物、不平等、敲诈勒索"
  },
  {
    upright: "收获、奖励、结果、成长、进步、毅力、耐心、计划",
    reversed: "未完成的工作、拖延、低努力、浪费、缺乏成长、挫折、急躁"
  },
  {
    upright: "技能、才能、质量、高标准、专业知识、掌握、承诺、奉献、成就",
    reversed: "缺乏素质、仓促工作、名声不好、缺乏动力、平庸、懒惰、低技能"
  },
  {
    upright: "有回报的努力、成功、成就、独立、休闲、物质保障、自给自足",
    reversed: "被守卫、物质不稳定、不计后果"
  },
  {
    upright: "遗产、根源、家庭、祖先、继承、意外之财、特权、富裕、稳定、传统",
    reversed: "家庭纠纷、破产、债务、转瞬即逝的成功、金钱冲突、不稳定、打破传统"
  },
  {
    upright: "雄心、勤奋、目标导向、计划者、好学、脚踏实地、忠诚、忠实、可靠",
    reversed: "愚蠢的、不成熟的、懒惰的、成绩不佳、拖延、错失机会、糟糕前景"
  },
  {
    upright: "实用、可靠、高效、坚忍、缓慢而稳定、勤奋、忠诚、耐心、保守",
    reversed: "工作狂、懒惰、沉闷、无聊、不主动、廉价、不负责、赌徒、冒险投资"
  },
  {
    upright: "慷慨、关怀、培育、居家、商业意识、实用、舒适、热情、明智、豪华",
    reversed: "自私、蓬头垢面、嫉妒、缺乏安全感、贪婪、物质主义、淘金者、不宽容"
  },
  {
    upright: "丰富、繁荣、安全、雄心、善良、重男轻女、保护性、感性、可靠",
    reversed: "贪婪、物质、浪费、糟糕的财务决策、赌徒、占有欲"
  },

  // 宝剑牌 (50-63)
  {
    upright: "清晰、突破、新想法、专注、远见、力量、真理",
    reversed: "混乱、沟通不畅、敌意、争论、破坏"
  },
  {
    upright: "僵局、艰难抉择、左右为难、否认、隐藏信息",
    reversed: "优柔寡断、犹豫、焦虑、没有正确的选择、真相大白"
  },
  {
    upright: "心碎、分离、悲伤、不安、失落、创伤、眼泪",
    reversed: "治愈、宽恕、恢复、和解、压抑情绪"
  },
  {
    upright: "休息、放松、和平、庇护、疗养、自我保护、恢复活力",
    reversed: "恢复、觉醒、重新进入世界、摆脱孤立、烦躁、倦怠"
  },
  {
    upright: "争论、纠纷、侵略、欺凌、恐吓、冲突、敌意、压力",
    reversed: "和解、解决、妥协、报复、后悔、悔恨、减少损失"
  },
  {
    upright: "继续前进、离开、留下、距离、接受教训",
    reversed: "困在过去、重蹈覆辙、逃避问题、陷入困境"
  },
  {
    upright: "谎言、诡计、策略、足智多谋、偷偷摸摸、狡猾",
    reversed: "忏悔、良心、悔恨、恶意、真相"
  },
  {
    upright: "被困、受限、受害、瘫痪、无助、无能为力、监禁",
    reversed: "自由、释放、控制、幸存者、恐惧、投降"
  },
  {
    upright: "恐惧、焦虑、消极、崩溃、绝望、噩梦、孤立",
    reversed: "康复、学习面对、寻求帮助、羞耻、内疚、心理问题"
  },
  {
    upright: "毁灭、失败、痛苦、崩溃、疲惫、死胡同、受害、背叛",
    reversed: "生存、改善、治愈、经验教训、绝望、复发"
  },
  {
    upright: "好奇、诙谐、健谈、善于交际、有灵感、警惕、警觉、思维敏捷",
    reversed: "散漫、愤世嫉俗、讽刺、八卦、侮辱、粗鲁、缺乏计划"
  },
  {
    upright: "自信、直接、不耐烦、聪明、大胆、专注、完美主义者、雄心",
    reversed: "粗鲁、不圆滑、强硬、欺凌、好斗、恶毒、无情、傲慢"
  },
  {
    upright: "诚实、独立、有原则、公平、建设性批评、客观、有洞察力",
    reversed: "悲观的、恶意的、操纵性的、苛刻的、苦涩的、残忍的、欺骗的、无情的"
  },
  {
    upright: "理性、权威、纪律、诚信、道德、严肃、高标准",
    reversed: "非理性的、独裁者、压迫、控制性的、冷酷无情、不诚实的"
  },

  // 权杖牌 (64-77)
  {
    upright: "灵感、创意火花、新建议、新激情、热情、活力",
    reversed: "延迟、阻碍、缺乏激情、缺乏活力、犹豫、创意阻碍"
  },
  {
    upright: "计划、第一步、做出决定、留下舒适感、承担风险",
    reversed: "糟糕的计划、过度分析、不采取行动、谨慎行事、规避风险"
  },
  {
    upright: "动力、信心、扩张、增长、远见、展望",
    reversed: "限制、局限、缺乏进展、障碍、延误、挫折"
  },
  {
    upright: "社区、家庭、庆典、聚会、稳定、归属感",
    reversed: "缺乏支持、不稳定、感觉不受欢迎、短暂、缺乏根源、家庭冲突"
  },
  {
    upright: "冲突、竞争、争论、侵略、紧张、对手、自我冲突",
    reversed: "冲突结束、合作、协议、休战、和谐、和平、避免冲突"
  },
  {
    upright: "成功、胜利、奖励、认可、赞美、赞誉、骄傲",
    reversed: "失败、缺乏认可、没有奖励、缺乏成就"
  },
  {
    upright: "保护自己、为自己挺身而出、保护领土",
    reversed: "放弃、认输、让步、缺乏自信、投降"
  },
  {
    upright: "运动、速度、进步、快速决定、突然变化、兴奋",
    reversed: "等待、缓慢、混乱、延误、失去动力、仓促、毫无准备"
  },
  {
    upright: "最后立场、坚持、毅力、韧性、接近成功、疲劳",
    reversed: "顽固、僵硬、防御、拒绝妥协、放弃"
  },
  {
    upright: "负担、责任、义务、压力、义务、精疲力竭、斗争",
    reversed: "不下放、肩负太多责任、崩溃、崩溃"
  },
  {
    upright: "冒险、兴奋、新鲜的想法、开朗、精力充沛、无所畏惧、外向",
    reversed: "仓促、不耐烦、缺乏想法、发脾气、懒惰、无聊、不可靠、心烦意乱"
  },
  {
    upright: "勇敢、精力充沛、迷人、英雄、叛逆、脾气暴躁、自由精神",
    reversed: "傲慢、鲁莽、不耐烦、缺乏自制力、被动、易变、专横"
  },
  {
    upright: "自信、热情、坚定、社交、有魅力、活泼、乐观",
    reversed: "苛求、报复心强、自信心不足、嫉妒、自私、喜怒无常、欺负人"
  },
  {
    upright: "领导力、远见、大局、掌控、大胆的决定、大胆、乐观",
    reversed: "强势、霸道、暴君、恶毒、无能为力、无效、软弱的领导者"
  }
];

document.addEventListener('DOMContentLoaded', function() {
    const questionButtons = document.querySelectorAll('.question-btn');
    const hiddenInput = document.getElementById('inputText');

    questionButtons.forEach(button => {
        button.addEventListener('click', function() {
            // 移除所有按钮的 active 类
            questionButtons.forEach(btn => btn.classList.remove('active'));
            // 为当前点击的按钮添加 active 类
            this.classList.add('active');
            // 更新隐藏输入框的值
            hiddenInput.value = this.getAttribute('data-value');
        });
    });

    // 卡牌翻转的事件监听
    const cardInner = document.querySelector('.card-inner');
    cardInner.addEventListener('click', function() {
        if (!this.classList.contains('flipped')) {  // 防止重复点击
            drawRandomCard();
        }
    });
});

async function drawRandomCard() {
    const inputText = document.getElementById('inputText').value;
    if (!inputText.trim()) {
        alert("请先选择想要解答的问题");
        return;
    }

    const cardInner = document.querySelector('.card-inner');
    cardInner.classList.add('flipped');  // 添加翻转类名

    const cardIndex = Math.floor(Math.random() * allTarotCards.length);
    const isReversed = Math.random() < 0.5;
    const card = allTarotCards[cardIndex];
    
    const drawnCard = document.getElementById('drawnCard');
    
    const cardContainer = document.createElement('div');
    cardContainer.style.display = 'flex';
    cardContainer.style.flexDirection = 'column';
    cardContainer.style.alignItems = 'center';
    cardContainer.style.height = '100%';
    
    const newCardImg = document.createElement('img');
    newCardImg.src = `${cdnBaseUrl}${card.number}.jpg`;
    newCardImg.alt = card.name;
    newCardImg.className = 'tarot-card';
    newCardImg.style.marginBottom = '10px';
    
    if (isReversed) {
        newCardImg.style.transform = 'rotate(180deg)';
    }
    
    const cardName = document.createElement('div');
    cardName.textContent = `${isReversed ? "逆位 " : ""}${card.name}`;
    cardName.style.color = '#fff';
    cardName.style.fontSize = '1.2rem';
    cardName.style.textAlign = 'center';
    cardName.style.marginTop = '10px';
    cardName.style.textShadow = '2px 2px 4px rgba(0, 0, 0, 0.3)';
    
    cardContainer.appendChild(newCardImg);
    cardContainer.appendChild(cardName);
    
    drawnCard.innerHTML = '';
    drawnCard.appendChild(cardContainer);

    drawnCards.push({
        number: card.number,
        reversed: isReversed,
        name: card.name,
        description: isReversed ? cardDescriptions[cardIndex].reversed : cardDescriptions[cardIndex].upright
    });

    const outputText = document.getElementById('outputText');
    const cardDescription = `<em>${isReversed ? cardDescriptions[cardIndex].reversed : cardDescriptions[cardIndex].upright}</em>`;
    outputText.innerHTML = `<strong>牌意简介</strong><br>${cardDescription}`;

    // 自动进行 AI 解读
    await aiInterpretation();
}

function resetCards() {
    // 刷新页面
    window.location.reload();
}

// 或者如果你不想刷新页面，可以尝试这个完整的重置版本：
function resetCards() {
    // 重置抽牌数组
    drawnCards = [];
    
    // 重置卡片到初始状态
    const cardInner = document.querySelector('.card-inner');
    if (cardInner) {
        // 移除所有类
        cardInner.className = 'card-inner';
        
        // 重置卡片正面图片
        const frontImg = cardInner.querySelector('.card-front img');
        if (frontImg) {
            frontImg.src = 'https://sydf.cc/img/today/00.jpg';
        }
    }
    
    // 清空抽取的卡片内容
    const drawnCard = document.getElementById('drawnCard');
    if (drawnCard) {
        drawnCard.innerHTML = '';
    }
    
    // 重置按钮状态
    const resetButton = document.getElementById('resetButton');
    const copyButton = document.getElementById('copyButton');
    if (resetButton) resetButton.style.display = 'none';
    if (copyButton) copyButton.style.display = 'none';
    
    // 清空输出文本
    const outputText = document.getElementById('outputText');
    if (outputText) {
        outputText.innerHTML = '';
    }
    
    // 重置问题选择
    const questionButtons = document.querySelectorAll('.question-btn');
    questionButtons.forEach(btn => btn.classList.remove('active'));
    
    // 清空输入
    const inputText = document.getElementById('inputText');
    if (inputText) {
        inputText.value = '';
    }
    
    // 重置时隐藏提示文字
    document.getElementById('reminderText').style.display = 'none';
}
    </script>
</body>
</html>